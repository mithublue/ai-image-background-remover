<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Background Remover</title>
	<script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 min-h-screen flex items-center justify-center">
<div class="container mx-auto px-4 py-8 max-w-4xl">
	<h1 class="text-3xl font-bold text-center mb-8 text-gray-800">Background Remover</h1>
	<div class="bg-white shadow-md rounded-lg p-6">
		<form id="uploadForm" enctype="multipart/form-data" class="mb-6">
			<div class="mb-4">
				<label for="image" class="block text-sm font-medium text-gray-700 mb-2">Upload Image</label>
				<input type="file" name="image" id="image" accept="image/*" required
				       class="block w-full text-sm text-gray-500
                                  file:mr-4 file:py-2 file:px-4
                                  file:rounded-md file:border-0
                                  file:text-sm file:font-semibold
                                  file:bg-blue-50 file:text-blue-700
                                  hover:file:bg-blue-100">
			</div>
			<button type="submit"
			        class="w-full bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-4 rounded-md transition duration-300">
				Remove Background
			</button>
		</form>

		<div class="grid grid-cols-1 md:grid-cols-2 gap-6">
			<div>
				<h2 class="text-lg font-semibold mb-2 text-gray-700">Original Image</h2>
				<div id="originalImageContainer" class="aspect-w-16 aspect-h-9 bg-gray-200 rounded-md overflow-hidden hidden">
					<img id="originalImage" src="" alt="Original image will appear here" class="object-contain w-full h-full">
				</div>
			</div>
			<div>
				<h2 class="text-lg font-semibold mb-2 text-gray-700">Processed Image</h2>
				<div id="processedImageContainer" class="aspect-w-16 aspect-h-9 bg-gray-200 rounded-md overflow-hidden hidden">
					<img id="outputImage" src="" alt="Processed image will appear here" class="object-contain w-full h-full">
				</div>
				<button id="downloadBtn" class="mt-4 w-full bg-green-500 hover:bg-green-600 text-white font-bold py-2 px-4 rounded-md transition duration-300 hidden">
					Download Processed Image
				</button>
			</div>
		</div>
	</div>
</div>

<script>
	const form = document.getElementById('uploadForm');
	const originalImage = document.getElementById('originalImage');
	const outputImage = document.getElementById('outputImage');
	const originalImageContainer = document.getElementById('originalImageContainer');
	const processedImageContainer = document.getElementById('processedImageContainer');
	const downloadBtn = document.getElementById('downloadBtn');

	form.addEventListener('submit', async (e) => {
		e.preventDefault();

		const formData = new FormData(form);

		// Display original image
		const file = form.image.files[0];
		if (file) {
			const reader = new FileReader();
			reader.onload = function(e) {
				originalImage.src = e.target.result;
				originalImageContainer.classList.remove('hidden');
			}
			reader.readAsDataURL(file);
		}

		try {
			const response = await fetch('/remove-background', {
				method: 'POST',
				body: formData
			});

			if (!response.ok) {
				throw new Error('Failed to process the image.');
			}

			const blob = await response.blob();
			const url = URL.createObjectURL(blob);

			outputImage.src = url;
			processedImageContainer.classList.remove('hidden');

			// Enable download button
			downloadBtn.classList.remove('hidden');
			downloadBtn.onclick = () => {
				const a = document.createElement('a');
				a.href = url;
				a.download = 'processed_image.png';
				document.body.appendChild(a);
				a.click();
				document.body.removeChild(a);
			};
		} catch (err) {
			alert(err.message);
		}
	});

	// Hide image containers when a new file is selected
	form.image.addEventListener('change', () => {
		originalImageContainer.classList.add('hidden');
		processedImageContainer.classList.add('hidden');
		downloadBtn.classList.add('hidden');
	});
</script>
</body>
</html>

